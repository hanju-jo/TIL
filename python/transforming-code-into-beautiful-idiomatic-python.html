
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Transforming Code Into Beautiful Idiomatic Python Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="python-virtualenv.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Categories</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Data Visualization
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../data-visualization/d3.js-tutorial.html">
            
                <a href="../data-visualization/d3.js-tutorial.html">
            
                    
                    D3 Tutorial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Database
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../database/mongodb-setup.html">
            
                <a href="../database/mongodb-setup.html">
            
                    
                    Mongodb Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../database/postgresql-on-ubuntu.html">
            
                <a href="../database/postgresql-on-ubuntu.html">
            
                    
                    Postgresql On Ubuntu
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Design Patterns
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../design-patterns/abstract-factory.html">
            
                <a href="../design-patterns/abstract-factory.html">
            
                    
                    Abstract Factory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../design-patterns/adapter.html">
            
                <a href="../design-patterns/adapter.html">
            
                    
                    Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../design-patterns/decorator.html">
            
                <a href="../design-patterns/decorator.html">
            
                    
                    Decorator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../design-patterns/delegation.html">
            
                <a href="../design-patterns/delegation.html">
            
                    
                    Delegation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../design-patterns/factory.html">
            
                <a href="../design-patterns/factory.html">
            
                    
                    Factory
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Django
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../django/deploying-django-project-on-ubuntu-using-nginx-and-gunicorn.html">
            
                <a href="../django/deploying-django-project-on-ubuntu-using-nginx-and-gunicorn.html">
            
                    
                    Deploying Django Project On Ubuntu Using Nginx And Gunicorn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../django/django-bluebook.html">
            
                <a href="../django/django-bluebook.html">
            
                    
                    Django Bluebook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../django/django-setup.html">
            
                <a href="../django/django-setup.html">
            
                    
                    Django Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../django/django-with-postgresql-on-aws-ec2.html">
            
                <a href="../django/django-with-postgresql-on-aws-ec2.html">
            
                    
                    Django With Postgresql On Aws Ec2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../django/test-driven-development-with-python.html">
            
                <a href="../django/test-driven-development-with-python.html">
            
                    
                    Test Driven Development With Python
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Docker
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../docker/about-docker.html">
            
                <a href="../docker/about-docker.html">
            
                    
                    About Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../docker/docker-cheatsheet.html">
            
                <a href="../docker/docker-cheatsheet.html">
            
                    
                    Docker Cheatsheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../docker/docker-for-jekyll.html">
            
                <a href="../docker/docker-for-jekyll.html">
            
                    
                    Docker For Jekyll
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../docker/gollum-via-docker.html">
            
                <a href="../docker/gollum-via-docker.html">
            
                    
                    Gollum Via Docker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    English
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../english/newly-learned-words-or-phrases.html">
            
                <a href="../english/newly-learned-words-or-phrases.html">
            
                    
                    Newly Learned Words Or Phrases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    Git
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../git/git-cheat-sheet.html">
            
                <a href="../git/git-cheat-sheet.html">
            
                    
                    Git Cheat Sheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../git/steps-after-fork.html">
            
                <a href="../git/steps-after-fork.html">
            
                    
                    Steps After Fork
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    Jekyll
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../jekyll/add-disqus-to-jekyll.html">
            
                <a href="../jekyll/add-disqus-to-jekyll.html">
            
                    
                    Add Disqus To Jekyll
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../jekyll/jekyll-with-google-analytics.html">
            
                <a href="../jekyll/jekyll-with-google-analytics.html">
            
                    
                    Jekyll With Google Analytics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    Machine Learning
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../ml/ml-study-notes.html">
            
                <a href="../ml/ml-study-notes.html">
            
                    
                    Ml Study Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    Python
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="effective-python.html">
            
                <a href="effective-python.html">
            
                    
                    Effective Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="fundamental-python.html">
            
                <a href="fundamental-python.html">
            
                    
                    Fundamental Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="python-react-setup.html">
            
                <a href="python-react-setup.html">
            
                    
                    Python React Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="python-tips.html">
            
                <a href="python-tips.html">
            
                    
                    Python Tips
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="python-virtualenv.html">
            
                <a href="python-virtualenv.html">
            
                    
                    Python Virtualenv
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.11.6" data-path="transforming-code-into-beautiful-idiomatic-python.html">
            
                <a href="transforming-code-into-beautiful-idiomatic-python.html">
            
                    
                    Transforming Code Into Beautiful Idiomatic Python
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    React.js
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../reactjs/reactjs-setup.html">
            
                <a href="../reactjs/reactjs-setup.html">
            
                    
                    Reactjs Setup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    Snippets
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../snippets/c++.html">
            
                <a href="../snippets/c++.html">
            
                    
                    C++
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    Uncategorized
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../uncategorized/dotfiles.html">
            
                <a href="../uncategorized/dotfiles.html">
            
                    
                    Dotfiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../uncategorized/hmac.html">
            
                <a href="../uncategorized/hmac.html">
            
                    
                    HMAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../uncategorized/unix-command-tips.html">
            
                <a href="../uncategorized/unix-command-tips.html">
            
                    
                    Unix Command Tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
                <span>
            
                    
                    Vim
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../vim/plugin-manager-vim-plug.html">
            
                <a href="../vim/plugin-manager-vim-plug.html">
            
                    
                    Plugin Manager Vim Plug
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../vim/plugin-manager-vundle.html">
            
                <a href="../vim/plugin-manager-vundle.html">
            
                    
                    Plugin Manager Vundle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="../vim/plugin-youcompleteme.html">
            
                <a href="../vim/plugin-youcompleteme.html">
            
                    
                    Plugin Youcompleteme
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Transforming Code Into Beautiful Idiomatic Python</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="transforming-code-into-beautiful-idiomatic-python">Transforming Code into Beautiful, Idiomatic Python</h1>
<ul>
<li>Speaker: Raymond Hettinger(@raymondh), who is Python core developer</li>
<li>Lecture on Youtube: <a href="https://www.youtube.com/watch?v=OSGv2VnC0go&amp;t=503s" target="_blank">Transforming Code into Beautiful, Idiomatic Python</a></li>
</ul>
<h2 id="when-you-see-this-do-that-instead">When you see this, do that instead!</h2>
<ul>
<li>Replace traditional index manipulation with Python&apos;s core looping idioms</li>
<li>Learn advanced techniques with for-else clauses and the two argument form of iter()</li>
<li>Improve your craftmanship and aim for clean, fast, idiomatic Python code</li>
</ul>
<h3 id="looping-over-a-range-of-numbers">Looping over a range of numbers</h3>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]:
    print(i**<span class="hljs-number">2</span>)

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">6</span>):
    print(i**<span class="hljs-number">2</span>)
</code></pre>
<h3 id="looping-over-a-collection">Looping over a collection</h3>
<pre><code class="lang-python">colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;yellow&apos;</span>]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(colors)):
    print(colors[i])

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> colors:
    print(color)
</code></pre>
<h3 id="looping-backwards">Looping backwards</h3>
<pre><code class="lang-python">colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;yellow&apos;</span>]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(colors)<span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>):
    print(colors[i])

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> reversed(colors):
    print(color)
</code></pre>
<h3 id="looping-over-a-collection-and-indicies">Looping over a collection and indicies</h3>
<pre><code class="lang-python">colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;yellow&apos;</span>]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(colors)):
    print(i, <span class="hljs-string">&apos;--&gt;&apos;</span>, colors[i])

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">for</span> i, color <span class="hljs-keyword">in</span> enumerate(colors):
    print(i, <span class="hljs-string">&apos;--&gt;&apos;</span>, colors)
</code></pre>
<h3 id="looping-over-two-collections">Looping over two collections</h3>
<pre><code class="lang-python">names = [<span class="hljs-string">&apos;raymond&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>, <span class="hljs-string">&apos;matthew&apos;</span>]
colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;yellow&apos;</span>]

n = min(len(names), len(colors))
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n):
    print(names[i], <span class="hljs-string">&apos;--&gt;&apos;</span>, colors[i])

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">for</span> name, color <span class="hljs-keyword">in</span> zip(names, colors):
    print(name, <span class="hljs-string">&apos;--&gt;&apos;</span>, color)
</code></pre>
<h3 id="looping-in-sorted-order">Looping in sorted order</h3>
<pre><code class="lang-python">colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;yellow&apos;</span>]

<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> sorted(colors):
    print(color)

<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> sorted(colors, reverse=<span class="hljs-keyword">True</span>):
    print(color)
</code></pre>
<h3 id="custom-sort-order">Custom sort order</h3>
<pre><code class="lang-python">colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;yellow&apos;</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compare_length</span><span class="hljs-params">(c1, c2)</span>:</span>
    <span class="hljs-keyword">if</span> len(c1) &lt; len(c2): <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">if</span> len(c1) &gt; len(c2): <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

<span class="hljs-comment"># in python2</span>
<span class="hljs-keyword">print</span> sorted(colors, cmp=compare_length)

<span class="hljs-comment"># Pythonic-way</span>
print(sorted(colors, key=len))
</code></pre>
<h3 id="call-a-function-until-a-sentinel-value">Call a function until a sentinel value</h3>
<pre><code class="lang-python">blocks = []
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    block = f.read(<span class="hljs-number">32</span>)
    <span class="hljs-keyword">if</span> block == <span class="hljs-string">&apos;&apos;</span>:
        <span class="hljs-keyword">break</span>
    blocks.append(block)

<span class="hljs-comment"># Pythonic-way</span>
blocks = []
<span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> iter(partial(f.read, <span class="hljs-number">32</span>), <span class="hljs-string">&apos;&apos;</span>):
    blocks.append(block)
</code></pre>
<h3 id="distinguishing-multiple-exit-points-in-loops">Distinguishing multiple exit points in loops</h3>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find</span><span class="hljs-params">(seq, target)</span>:</span>
    found = <span class="hljs-keyword">False</span>
    <span class="hljs-keyword">for</span> i, value <span class="hljs-keyword">in</span> enumerate(seq):
        <span class="hljs-keyword">if</span> value == target:
            found = <span class="hljs-keyword">True</span>
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">return</span> i

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find</span><span class="hljs-params">(seq, target)</span>:</span>
    <span class="hljs-keyword">for</span> i, value <span class="hljs-keyword">in</span> enumerate(seq):
        <span class="hljs-keyword">if</span> value == target:
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">return</span> i
</code></pre>
<h2 id="dictionary-skills">Dictionary Skills</h2>
<ul>
<li>Mastering dictionaries is a fundamental Python skill</li>
<li>They are fundament tool for expressing relationships, linking, counting and grouping</li>
</ul>
<h3 id="looping-over-dictionary-keys">Looping over dictionary keys</h3>
<pre><code class="lang-python">d = {<span class="hljs-string">&apos;matthew&apos;</span>: <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>: <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;raymond&apos;</span>: <span class="hljs-string">&apos;red&apos;</span>}

<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> d:
    print(k)

<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> d.keys():
    <span class="hljs-keyword">if</span> k.startswith(<span class="hljs-string">&apos;r&apos;</span>):
        <span class="hljs-keyword">del</span> d[k]
</code></pre>
<h3 id="looping-over-a-dictionary-keys-and-values">Looping over a dictionary keys and values</h3>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> d:
    print(k, <span class="hljs-string">&apos;--&gt;&apos;</span>, d[k])

<span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> d.items():
    print(k, <span class="hljs-string">&apos;--&gt;&apos;</span>, v)
</code></pre>
<h3 id="construct-a-dictionary-in-pairs">Construct a dictionary in pairs</h3>
<pre><code class="lang-python">names = [<span class="hljs-string">&apos;raymond&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>, <span class="hljs-string">&apos;matthew&apos;</span>]
colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>]

d = dict(zip(names, colors))  <span class="hljs-comment"># {&apos;raymond&apos;: &apos;red&apos;, &apos;rachel&apos;: &apos;green&apos;, &apos;matthew&apos;: &apos;blue&apos;}</span>
d = dict(enumerate(names))  <span class="hljs-comment"># {0: &apos;raymond&apos;, 1: &apos;rachel&apos;, 2: &apos;matthew&apos;}</span>
</code></pre>
<h3 id="counting-with-dictionaries">Counting with dictionaries</h3>
<pre><code class="lang-python">colors = [<span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;red&apos;</span>]

d = {}
<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> colors:
    <span class="hljs-keyword">if</span> color <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> d:
        d[color] = <span class="hljs-number">0</span>
    d[color] += <span class="hljs-number">1</span>
<span class="hljs-comment"># {&apos;blue&apos;: 1, &apos;green&apos;: 2, &apos;red&apos;: 3}</span>

<span class="hljs-comment"># Pythonic-way</span>
d = {}
<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> colors:
    d[color] = d.get(color, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>

<span class="hljs-comment"># Pythonic and modern way</span>
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict

d = defaultdict(int)
<span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> colors:
    d[color] += <span class="hljs-number">1</span>
</code></pre>
<h3 id="grouping-with-dictionaries">Grouping with dictionaries</h3>
<pre><code class="lang-python">names = [<span class="hljs-string">&apos;raymond&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>, <span class="hljs-string">&apos;matthew&apos;</span>, <span class="hljs-string">&apos;roger&apos;</span>, <span class="hljs-string">&apos;betty&apos;</span>, <span class="hljs-string">&apos;melissa&apos;</span>, <span class="hljs-string">&apos;judith&apos;</span>, <span class="hljs-string">&apos;charlie&apos;</span>]

d = {}
<span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> names:
    key = len(name)
    <span class="hljs-keyword">if</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> d:
        d[key] = []
    d[key].append(name)
<span class="hljs-comment"># {7: [&apos;raymond&apos;, &apos;matthew&apos;, &apos;melissa&apos;, &apos;charlie&apos;], 6: [&apos;rachel&apos;, &apos;judith&apos;], 5: [&apos;roger&apos;, &apos;betty&apos;]}</span>

<span class="hljs-comment"># Pythonic-way</span>
d = {}
<span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> names:
    key = len(name)
    d.setdefault(key, []).append(name)

<span class="hljs-comment"># Pythonic and modern way</span>
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict

d = defaultdict(list)
<span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> names:
    key = len(name)
    d[key].append(name)
</code></pre>
<h3 id="is-a-dictionary-popitem-atomic">Is a dictionary popitem() atomic?</h3>
<pre><code class="lang-python">d = {<span class="hljs-string">&apos;matthew&apos;</span>: <span class="hljs-string">&apos;blue&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>: <span class="hljs-string">&apos;green&apos;</span>, <span class="hljs-string">&apos;raymond&apos;</span>: <span class="hljs-string">&apos;red&apos;</span>}

<span class="hljs-keyword">while</span> d:
    key, value = d.popitem()
    print(key, <span class="hljs-string">&apos;--&gt;&apos;</span>, value)
</code></pre>
<h3 id="linking-dictionaries">Linking dictionaries</h3>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> os

defaults = {<span class="hljs-string">&apos;color&apos;</span>: <span class="hljs-string">&apos;red&apos;</span>, <span class="hljs-string">&apos;user&apos;</span>: <span class="hljs-string">&apos;guest&apos;</span>}
parser = argparse.ArgumentParser()
parser.add_argument(<span class="hljs-string">&apos;-u&apos;</span>, <span class="hljs-string">&apos;--user&apos;</span>)
parser.add_argument(<span class="hljs-string">&apos;-c&apos;</span>, <span class="hljs-string">&apos;--color&apos;</span>)
namespace = parser.parse_args([])
command_line_args = {k: v <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> vars(namespace).items() <span class="hljs-keyword">if</span> v}

d = defaults.copy()
d.update(os.environ)
d.update(command_line_args)

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> ChainMap

d = ChainMap(command_line_args, os.environ, defaults)
</code></pre>
<h2 id="improving-clarity">Improving Clarity</h2>
<ul>
<li>Positional arguments and indicies are nice</li>
<li>Keywords and names are better</li>
<li>The first way is convenient for the computer</li>
<li>The second corresponds to how human&apos;s think</li>
</ul>
<h3 id="clarify-function-calls-with-keyword-arguments">Clarify function calls with keyword arguments</h3>
<blockquote>
<p>  <em>Microseconds of computer time is hours of programmer time.</em></p>
</blockquote>
<pre><code class="lang-python">twitter_search(<span class="hljs-string">&apos;@obama&apos;</span>, <span class="hljs-keyword">False</span>, <span class="hljs-number">20</span>, <span class="hljs-keyword">True</span>)
twitter_search(<span class="hljs-string">&apos;@obama&apos;</span>, retweets=<span class="hljs-keyword">False</span>, numtweets=<span class="hljs-number">20</span>, popular=<span class="hljs-keyword">True</span>)
</code></pre>
<h3 id="clarify-multiple-return-values-with-named-tuples">Clarify multiple return values with named tuples</h3>
<pre><code class="lang-python">doctest.testmod()  <span class="hljs-comment"># (0, 4)</span>
doctest.testmod()  <span class="hljs-comment"># TestResults(failed=0, attempted=4)</span>
TestResults = namedtuple(<span class="hljs-string">&apos;TestResults&apos;</span>, [<span class="hljs-string">&apos;failed&apos;</span>, [<span class="hljs-string">&apos;attempted&apos;</span>]])
</code></pre>
<h3 id="unpacking-sequences">Unpacking sequences</h3>
<pre><code class="lang-python">p = <span class="hljs-string">&apos;Raymond&apos;</span>, <span class="hljs-string">&apos;Hettinger&apos;</span>, <span class="hljs-number">0x30</span>, <span class="hljs-string">&apos;python@example.com&apos;</span>

fname = p[<span class="hljs-number">0</span>]
lname = p[<span class="hljs-number">1</span>]
age = p[<span class="hljs-number">2</span>]
email = p[<span class="hljs-number">3</span>]

<span class="hljs-comment"># Pythonic-way</span>
fname, lname, age, email = p
</code></pre>
<h3 id="updating-multiple-state-variables">Updating multiple state variables</h3>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fibonacci</span><span class="hljs-params">(n)</span>:</span>
    x = <span class="hljs-number">0</span>
    y = <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n):
        print(x)
        t = y
        y = x + y
        x = t

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fibonacci</span><span class="hljs-params">(n)</span>:</span>
    x, y = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n):
        print(x)
        x, y = y, x+y
</code></pre>
<h2 id="tuple-packing-and-unpacking">Tuple packing and unpacking</h2>
<ul>
<li>Don&apos;t under-estimate the advantages of updating state variables at the same time</li>
<li>It eliminates an entire class of errors due to out-of-order updates</li>
<li>It allows high level thinking: &quot;chunking&quot;</li>
</ul>
<h3 id="simultaneous-state-updates">Simultaneous state updates</h3>
<pre><code class="lang-python">tmp_x = x + dx*t
tmp_y = y + dy+t
tmp_dx = influence(m, x, y, dx, dy, partial=<span class="hljs-string">&apos;x&apos;</span>)
tmp_dy = influence(m, x, y, dx, dy, partial=<span class="hljs-string">&apos;y&apos;</span>)
x = tmp_x
y = tmp_y
dx = tmp_dx
dy = tmp_dy

<span class="hljs-comment"># Pythonic-way</span>
x, y, dx, dy = (x + dx*t, 
                y + dy*t, 
                influence(m, x, y, dx, dy, partial=<span class="hljs-string">&apos;x&apos;</span>), 
                influence(m, x, y, dx, dy, partial=<span class="hljs-string">&apos;y&apos;</span>))
</code></pre>
<h2 id="efficiency">Efficiency</h2>
<ul>
<li>An optimization fundamental rule</li>
<li>Don&apos;t cause data to move around unnecessarily</li>
<li>It takes only a little care to avoid O(n**2) behavior instead of linear behavior</li>
</ul>
<h3 id="concatenating-strings">Concatenating strings</h3>
<pre><code class="lang-python">names = [<span class="hljs-string">&apos;raymond&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>, <span class="hljs-string">&apos;matthew&apos;</span>, <span class="hljs-string">&apos;roger&apos;</span>, 
         <span class="hljs-string">&apos;betty&apos;</span>, <span class="hljs-string">&apos;melissa&apos;</span>, <span class="hljs-string">&apos;judith&apos;</span>, <span class="hljs-string">&apos;charlie&apos;</span>]

s = names[<span class="hljs-number">0</span>]
<span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> names[<span class="hljs-number">1</span>:]:
    s += <span class="hljs-string">&apos;, &apos;</span> + name
print(s)  <span class="hljs-comment"># raymond, rachel, matthew, roger, betty, melissa, judith, charlie</span>

<span class="hljs-comment"># Pythonic-way</span>
print(<span class="hljs-string">&apos;, &apos;</span>.join(names))  <span class="hljs-comment"># raymond, rachel, matthew, roger, betty, melissa, judith, charlie</span>
</code></pre>
<h3 id="updating-sequences">Updating sequences</h3>
<pre><code class="lang-python">names = [<span class="hljs-string">&apos;raymond&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>, <span class="hljs-string">&apos;matthew&apos;</span>, <span class="hljs-string">&apos;roger&apos;</span>, 
         <span class="hljs-string">&apos;betty&apos;</span>, <span class="hljs-string">&apos;melissa&apos;</span>, <span class="hljs-string">&apos;judith&apos;</span>, <span class="hljs-string">&apos;charlie&apos;</span>]

<span class="hljs-keyword">del</span> names[<span class="hljs-number">0</span>]
names.pop(<span class="hljs-number">0</span>)
names.insert(<span class="hljs-number">0</span>, <span class="hljs-string">&apos;mark&apos;</span>)

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque

names = deque([<span class="hljs-string">&apos;raymond&apos;</span>, <span class="hljs-string">&apos;rachel&apos;</span>, <span class="hljs-string">&apos;matthew&apos;</span>, <span class="hljs-string">&apos;roger&apos;</span>, 
         <span class="hljs-string">&apos;betty&apos;</span>, <span class="hljs-string">&apos;melissa&apos;</span>, <span class="hljs-string">&apos;judith&apos;</span>, <span class="hljs-string">&apos;charlie&apos;</span>])
<span class="hljs-keyword">del</span> names[<span class="hljs-number">0</span>]
names.popleft()
names.appendleft(<span class="hljs-string">&apos;mark&apos;</span>)
</code></pre>
<h2 id="decorators-and-context-managers">Decorators and Context Managers</h2>
<ul>
<li>Helps separate business logic from administrative logic</li>
<li>Clean, beautiful tools for factoring code and improving code reuse</li>
<li>Good naming is essential</li>
<li>Remember the Spiderman rule: With great power, comes great responsibility!</li>
</ul>
<h3 id="using-decorators-to-factor-out-administrative-logic">Using decorators to factor-out administrative logic</h3>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">web_lookup</span><span class="hljs-params">(url, saved={})</span>:</span>
    <span class="hljs-keyword">if</span> url <span class="hljs-keyword">in</span> saved:
        <span class="hljs-keyword">return</span> saved[url]
    page = urllib.urlopen(url).read()
    saved[url] = page
    <span class="hljs-keyword">return</span> page

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-comment"># Caching decorator</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cache</span><span class="hljs-params">(func)</span>:</span>
    saved = {}
<span class="hljs-meta">    @wraps(func)</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">newfunc</span><span class="hljs-params">(*args)</span>:</span>
        <span class="hljs-keyword">if</span> args <span class="hljs-keyword">in</span> saved:
            <span class="hljs-keyword">return</span> newfunc(*args)
        result = func(*args)
        saved[args] = result
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">return</span> newfunc

<span class="hljs-meta">@cache</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">web_lookup</span><span class="hljs-params">(url)</span>:</span>
    <span class="hljs-keyword">return</span> urllib.urlopen(url).read()
</code></pre>
<h3 id="factor-out-temporary-contexts">Factor-out temporary contexts</h3>
<pre><code class="lang-python">old_context = getcontext().copy()
getcontext().prec = <span class="hljs-number">50</span>
print(Decimal(<span class="hljs-number">355</span>)/Decimal(<span class="hljs-number">113</span>))
setcontext(old_context)

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">with</span> localcontext(Context(prec=<span class="hljs-number">50</span>)):
    print(Decimal(<span class="hljs-number">355</span>)/Decimal(<span class="hljs-number">113</span>))
</code></pre>
<h3 id="how-to-open-and-close-files">How to open and close files</h3>
<pre><code class="lang-python">f = open(<span class="hljs-string">&apos;data.txt&apos;</span>)
<span class="hljs-keyword">try</span>:
    data = f.read()
<span class="hljs-keyword">finally</span>:
    f.close()

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">&apos;data.txt&apos;</span>) <span class="hljs-keyword">as</span> f:
    data = f.read()
</code></pre>
<h3 id="how-to-use-locks">How to use locks</h3>
<pre><code class="lang-python"><span class="hljs-comment"># Make a lock</span>
lock = threading.Lock()

<span class="hljs-comment"># Old-way to use a lock</span>
lock.acquire()
<span class="hljs-keyword">try</span>:
    print(<span class="hljs-string">&apos;Critical section 1&apos;</span>)
    print(<span class="hljs-string">&apos;Critical section 2&apos;</span>)
<span class="hljs-keyword">finally</span>:
    lock.release()

<span class="hljs-comment"># New-way to use a lock(# Pythonic-way)</span>
<span class="hljs-keyword">with</span> lock:
    print(<span class="hljs-string">&apos;Critical section 1&apos;</span>)
    print(<span class="hljs-string">&apos;Critical section 2&apos;</span>)
</code></pre>
<h3 id="factor-out-temporary-contexts">Factor-out temporary contexts</h3>
<pre><code class="lang-python"><span class="hljs-keyword">try</span>:
    os.remove(<span class="hljs-string">&apos;somefile.tmp&apos;</span>)
<span class="hljs-keyword">except</span> OSError:
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-meta">@contextmanager</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ignored</span><span class="hljs-params">(*exceptions)</span>:</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">yield</span>
    <span class="hljs-keyword">except</span> exceptions:
        <span class="hljs-keyword">pass</span>

<span class="hljs-keyword">with</span> ignored(OSError):
    os.remove(<span class="hljs-string">&apos;somefile.tmp&apos;</span>)
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">with</span> open(<span class="hljs-string">&apos;help.txt&apos;</span>, <span class="hljs-string">&apos;w&apos;</span>) <span class="hljs-keyword">as</span> f:
    oldstdout = sys.stdout
    sys.stdout = f
    <span class="hljs-keyword">try</span>:
        help(pow)
    <span class="hljs-keyword">finally</span>:
        sys.stdout = oldstdout

<span class="hljs-comment"># Pythonic-way</span>
<span class="hljs-meta">@contextmanager</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">redirect_stdout</span><span class="hljs-params">(fileobj)</span>:</span>
    oldstdout = sys.stdout
    sys.stdout = fileobj
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">yield</span> fieldobj
    <span class="hljs-keyword">finally</span>:
        sys.stdout = oldstdout

<span class="hljs-keyword">with</span> open(<span class="hljs-string">&apos;help.txt&apos;</span>, <span class="hljs-string">&apos;w&apos;</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">with</span> redirect_stdout(f):
        help(pow)
</code></pre>
<h2 id="concise-expressive-one-liners">Concise Expressive One-Liners</h2>
<ul>
<li>Two conficting rules:<ul>
<li>Don&apos;t put too much on one line</li>
<li>Don&apos;t break atoms of thought into subatomic particles</li>
</ul>
</li>
<li>Raymond&apos;s rule:<ul>
<li>One logical line of code equals one sentence in English</li>
</ul>
</li>
</ul>
<h3 id="list-comprehensions-and-generator-exprssions">List Comprehensions and Generator Exprssions</h3>
<pre><code class="lang-python">result = []
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    s = i ** <span class="hljs-number">2</span>
    result.append(s)
print(sum(result))

<span class="hljs-comment"># Pythonic-way</span>
result = sum(i**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>))
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="python-virtualenv.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Python Virtualenv">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Transforming Code Into Beautiful Idiomatic Python","level":"1.11.6","depth":2,"next":{"title":"React.js","level":"1.12","depth":1,"ref":"","articles":[{"title":"Reactjs Setup","level":"1.12.1","depth":2,"path":"reactjs/reactjs-setup.md","ref":"reactjs/reactjs-setup.md","articles":[]}]},"previous":{"title":"Python Virtualenv","level":"1.11.5","depth":2,"path":"python/python-virtualenv.md","ref":"python/python-virtualenv.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["ga"],"pluginsConfig":{"ga":{"configuration":"auto","token":"UA-114603670-1"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"python/transforming-code-into-beautiful-idiomatic-python.md","mtime":"2020-05-10T04:53:26.600Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-10T04:53:55.471Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

